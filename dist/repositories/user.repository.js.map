{"version":3,"sources":["../../src/repositories/user.repository.ts"],"sourcesContent":["import User from '~/models/user.model';\r\nimport filterUndefinedOrNullFields from '~/utils/filterUndefineOrNull';\r\n\r\nclass UserRepository {\r\n   async getAllUser({ page, limit, filter }) {\r\n      const filterEl = {\r\n         fullname: {\r\n            $regex: `.*${filter}.*`,\r\n            $options: 'i'\r\n         }\r\n      };\r\n\r\n      if (!page) {\r\n         const result = await User.find(filterEl)\r\n            .sort('createdAt')\r\n            ?.populate({ path: 'account', select: { password: 0 } });\r\n         return { result };\r\n      }\r\n\r\n      const result = await User.find(filterEl)\r\n         .sort('createdAt')\r\n         ?.populate({ path: 'account', select: { password: 0 } })\r\n         ?.select('-account.password')\r\n         ?.skip((page - 1) * limit)\r\n         .limit(limit);\r\n      const totalItem = await User.count(filterEl);\r\n\r\n      return {\r\n         result,\r\n         pagination: {\r\n            page: Number(page),\r\n            limit: Number(limit),\r\n            totalPage: Math.ceil(totalItem / limit)\r\n         }\r\n      };\r\n   }\r\n\r\n   async updateUser({ _id, fullname, phone, address, image, role }) {\r\n      const result = await User.findByIdAndUpdate(\r\n         _id,\r\n         filterUndefinedOrNullFields({ fullname, phone, address, image, role })\r\n      );\r\n\r\n      return result;\r\n   }\r\n}\r\n\r\nexport default UserRepository;\r\n"],"names":["UserRepository","getAllUser","page","limit","filter","User","filterEl","fullname","$regex","$options","result","find","sort","populate","path","select","password","skip","totalItem","count","pagination","Number","totalPage","Math","ceil","updateUser","_id","phone","address","image","role","findByIdAndUpdate","filterUndefinedOrNullFields"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;+BA+CA;;;eAAA;;;oDA/CiB;+DACuB;;;;;;AAExC,IAAA,AAAMA,iBAAN,MAAMA;IACH,MAAMC,WAAW,EAAEC,IAAI,EAAEC,KAAK,EAAEC,MAAM,EAAE,EAAE;YAelBC,iCAAAA,0BAAAA;QAdrB,MAAMC,WAAW;YACdC,UAAU;gBACPC,QAAQ,CAAC,EAAE,EAAEJ,OAAO,EAAE,CAAC;gBACvBK,UAAU;YACb;QACH;QAEA,IAAI,CAACP,MAAM;gBACaG;YAArB,MAAMK,SAAS,QAAML,mBAAAA,kBAAI,CAACM,IAAI,CAACL,UAC3BM,IAAI,CAAC,0BADYP,uCAAAA,iBAEhBQ,QAAQ,CAAC;gBAAEC,MAAM;gBAAWC,QAAQ;oBAAEC,UAAU;gBAAE;YAAE;YACzD,OAAO;gBAAEN;YAAO;QACnB;QAEA,MAAMA,SAAS,QAAML,kBAAAA,kBAAI,CAACM,IAAI,CAACL,UAC3BM,IAAI,CAAC,0BADYP,uCAAAA,2BAAAA,gBAEhBQ,QAAQ,CAAC;YAAEC,MAAM;YAAWC,QAAQ;gBAAEC,UAAU;YAAE;QAAE,gBAFpCX,gDAAAA,kCAAAA,yBAGhBU,MAAM,CAAC,kCAHSV,sDAAAA,gCAIhBY,IAAI,CAAC,AAACf,CAAAA,OAAO,CAAA,IAAKC,OACnBA,KAAK,CAACA;QACV,MAAMe,YAAY,MAAMb,kBAAI,CAACc,KAAK,CAACb;QAEnC,OAAO;YACJI;YACAU,YAAY;gBACTlB,MAAMmB,OAAOnB;gBACbC,OAAOkB,OAAOlB;gBACdmB,WAAWC,KAAKC,IAAI,CAACN,YAAYf;YACpC;QACH;IACH;IAEA,MAAMsB,WAAW,EAAEC,GAAG,EAAEnB,QAAQ,EAAEoB,KAAK,EAAEC,OAAO,EAAEC,KAAK,EAAEC,IAAI,EAAE,EAAE;QAC9D,MAAMpB,SAAS,MAAML,kBAAI,CAAC0B,iBAAiB,CACxCL,KACAM,IAAAA,6BAA2B,EAAC;YAAEzB;YAAUoB;YAAOC;YAASC;YAAOC;QAAK;QAGvE,OAAOpB;IACV;AACH;MAEA,WAAeV"}